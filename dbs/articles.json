{"_id":{"$oid":"5cd43ca4dca5b94454963cb6"},"meta":{"views":43,"likes":0,"comments":0},"keyword":["react-hooks"],"desc":"Hook 是 React 16.8 的新增特性。它可以让你在不编写 class 的情况下使用 state 以及其他的 React 特性 如果你在编写函数组件并意识到需要向其添加一些 state，以前的做法是必须将其它转化为 class。现在你可以在现有的函数组件中使用 Hook","numbers":"328","img_url":"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgGBgcGBQgHBwcJCQgKDBQNDAsLDBkSEw8UHRofHh0aHBwgJC4nICIsIxwcKDcpLDAxNDQ0Hyc5PTgyPC4zNDL/2wBDAQkJCQwLDBgNDRgyIRwhMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjL/wAARCADIAMgDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD3P603vilJzScUig7UUhbFAOaAFNBoJxSZoA8H/aElJ1LQoAx2pDK7L9WUf0rx/wDdqjM397k167+0D82r6Tjr9lfP03ivFJJOdgPyr0rSPwiFkm3t/dT09ahJIHBwKQn0puc0CH9OppwfH3eG9RUbdqbQBZ+1zbcFya6DQ/Dtz4m86C0vbcXyDMNtNLtM3+yhPBb2zXLVLHI8MivGcMvINAHWaPJr2na/aaY7XENzG+1YJhtKEnOMH1r6d0IyWe5GctBM29QRjyzgZGPTOa+f9I8WWfiS802z8U3Pl3NrIv2fVtvzqoOdkv8AeX0PVffmvdLCe5spNMs77Ektw7RrOhBVxsLBgffFRLctbHSiNIryXDEGUBgOeo4P9Knx0xWbdTvE0MxfCRMVYDPzKfoD0x/9etIMDg9jSEGOaMEdqWg470ACjj0pccUUUAHamN94jpUvao2Az70AMBGfwop2Pmz7UUgPNpPiXYRLtMGpKR1/cmnR/EvTWzk3w+sLU57MO7Exjk9cVJHp0Zf/AFK/lRoVYenxE0wjLSXgHvA1TwfEDSp5ljjupy56Awt/hTGs4wNohXH0rOu7CNZFcRgMoYjAo0A1ZPHNmj4NzIPrEf8ACj/hN4AMi6JHvCf8K5WKWOUZPDDrmrqkxsMAH607Dsef/GjWotXvNLlhmDkQsjYQrj5ge/1ryWvT/izbO1zpl0FxEY3ibHYg5/r+lRX/AMIteTSLbVdIKarZTwrKnk/LIoYA8oevXsTVRM2ea0VcuLa4tZ2iuEMUiHDxsMEH3FU6oQUUUUAFdR4U8I6t4v1QWmnQArwZZiMJEvqx/p1NT6D8PfEXiXTJ7/TdOeSCP7rM4XzT6Ln7x+leufAiK5sNM13T7yCS3mhuY2aORSrKSp6g/Sk2Ox5L4/8ADMHhLxO+kwzvKkcEbGR/4mZQTx2Gc13fwq8aLdvbeGtWlDPFIJdNmkb/AFbDgx59GBIH5d6wPjlj/hYzkd7SLP5GvO4biS2nSeFyjxsGRh1BHQ0t0B9MeItaubg69aQ3bwPYXcC5iJEgQxbmIH8XBPGMYB6dR1fh1Lp9JtZjqklxG6AqZEBOMcfN3zXz/ZeJ5vEfiqSIFo/7Tt1WUgAlrmOIhHTjj5gOPc16J4WkdfDVoTcyGHYfKKufu54wf0qGrF7nrQcdCcnucUeYOxrzQ3j+YFW4uD6/vW6VbWRnXK3lwOe0pouFj0ESqOM9Pajz0z1/SuCQzbf+P64J/wCuhqcrcEZW+uVPu2aLhY7b7TF3cCmmaMn74rh9uodBqUx+uP8ACnY1IEbdSk/FAaLisdv5q5+8KK4oS6sOl/n/AIAKKLjsWAqD8qmhVeahOQT9KsQn5fpSAawUc5qneY3J7gj9KvPzwRxVG8YfaIV7ZxTGcF5yCRsHBBq/BekAZII9qz7qNReTrsxhj/OoxHj7j4NMCXxTbW+r+GbyGbho4zNE391l5/xH410nwT8QLqfgkac75uNNkMZB67GJZT+e4f8AAa43U7iZNGvgVBBt5P5GuG+HniqXwr4rtrstts5CIbodjGTy34dfwpolnumqad4e+Ir3Olavpk+m65bKSjyRYfaDjdG3SROnB9e3Wvn/AMReE9S0DxHJos8LyXIcCLykLeap+6y+ua+mdV8UtpMlvdNYy3mjTxhvt9n+98r13KP4enzD8qh1KAHxvoWtC1jktPs01sbtWyVaTaY8jHQ7SAR3ft3VxWPmVPBXiiRXZdA1MBOW/wBFfj9K7LQfhJ4qmuYL+60q08hWDG1vZ9hkGehC8jPvivY/H/iy68HaAupWtgLv96I3yxAQEHDHHuMfjXB+FPjVNqevw2Or2NtBBcOI45YdwMZPA3ZJyM49KrmYWO9s/GWn6U1tpOt2f/CP3GzbDE5Bt2A/uSL8uPriuoV43/eptbzAPnXB3Dtz3HJ/OuV+IGj2+v8AgrUrecLvhha4hcjlHQE8fUAg+xryD4TeMptJ1+HRrqdjYXn7tEZvljk/hI9Mng/UelTa4D/jdp11D4yivmXNtdWyiJ8d0HzD69D+Iryevc/i94x0S+0w6Fb4u72OQSGZX+S3I6gH+IkcEdPxFeGVaEzoPBcph8b6G6jP+nQjHr84r3XR9Ii0zw7DDNNhLeV40QOpBXJw3B714R4Rid/GOihRk/bYW/JxXsR8+Yq0rBfWpkVE2JdWsoU8uKIFjxuqNDbORtuNvNZAjiiYYyxqMxopO2Qj61JR0YSaEBopFlHsasRarsAWVSp965RWuITmKbP41ZXVrlOJIw/1GaYjqV1OEjO4cUHVIQfvCuYGrxEfNbDNB1dP4bdfxFFhnUJq0P8AE/6UVy/9sydrZfyopWCx3J6ZzzUsTdTUDVIjYJ+tIQ8tis+6YebE2ejirbMATzVC8OVDA9GBpjOQ1HCajcDH8Zqrv6cVb1bjVpzjqQaqMR1pjK2oDzNOuox1aFhj8K8VyQeDXt5weD0NeNXsJtb64hPWORl/I1SIkdH4W+IGt+EXK6dcBrZjl7Wf5o2/DsfcYr1NPjjpF5pUqX+kXMdw8ZQxxSBkYkY+9wR+RxXz9g4pKdibn0D4Z+KOi+I9GbRfFvlxSunlvLL/AKm4HqSPut+mRnIp9j8LPBltfJqias81qjiRUNzH5fqAWHavnunByOlFgue/fEn4labHo91o2j3aXd5cJ5cssJykaHqA3Qkjjjpk968B3EHI4ptFCQN3HMxPU5ptGKXB9KYjqPAKbvFtrLj5YEklzjoQpx+uK9PVz3bn0rjPBFn9ntLi9cfvJsInH8IOSfxIH5Gup85z7c1DNFsWWY8EVFISJDUJc9C1Nkkw+d3WkMky+KeGmBwCaqhsfxdRTg+Oj0AWvMn9vypQ1wSOlVhK4H36XznHG6gC0EuX74oqsJ5MfeooGelSH5etSIflqGQjA/OnI2E71JIrNwcGqdySYT61MTweKgkIaJhQM5zWYj9uLY+8orOMR21p6qc3MZ9YxVEniqAreUcdK828bacbXWjcBMR3I3A+/evTy3FZmuaQmt6cYGwJV+aJz2P+FNMTV0eN7KcoA61bubOazuHhmjKyRnBB7VBs3VZmR7Kd5fy7qkwq0tAEW0elAjAPzVLs+Xil2ZNWBEEx2rc8P6A+sagIyRFAhBlmIOFH+J7V1fgj4V6r4nu4Z7tDZaaW+aVsb3A6hV/qePrXVnT7PRp5rGxi228UrKuepwcZPqeP89KzbKSM9IfLjjijGI1QKgA6AcCnCFz2arpcjtTSzk+9QWQC2c/w8UslqzMMDtzzUxYnq2KHyFUsfxoAr/ZH6YHT1pfsjA9qcG/2hSg8/fpgM+yN6Cg22P7tOJHB30bk9TigBPs+O4op2U96KBnfv93k09WGxeagkPyjpx1pVOUHNQIJWAFQ5Uq3NOmPydagjcZ5NAGNqq7pIm/2SDVDac4rUvuVB7BiOaoEYPKVQELISg9aYu5XyPWrRG4LhR0p0cDythVHHU46UAYOq6JaauuLiPDYwsi/fFczc/DfUVs5Ly2nimhUnhlKuf516ZEtjGz/AGySQKAAgjQcnPOTzwBnsc1tJrOjrEscV3GiqMAMCP507isfPaeF9aaPf/Z8gXHU4H86b/YN+7YMGw7urn/CveL3UtKkXBurcg+jCufuYtMeTclzb5PbdT5gscBpvg2S6kAuLggekY/qf8K73RvAWn2N1DeRoxkhYMC/zcjpweKu6TZrPdBLZhM5GQsfzH8hXpmjeGcQrJdMVJH3AMEfWk5Nhoje0uILYwsQMldxPTmvDbzc15M+/wC9Ix/M179DEIIFjXoowDXiF55UV1NG0KZSRlPHcHFISMch+eaTDH+Loa0jNHz+4T8qT7Wo+7CmfpRcoorAztwsjH2FT3FrKIVUI3FPa8mI2gheOwpolk27txz9aAKZhcdVf8qaI24wrH6CtBb64Xjdn6ihtSnHAI6+lAFVLKZ8Yhc/hVqPSrlv+WKL/vNTDf3TjmQ/hxURnnf7zsfxpgaK6SwA3z26UVl/ORyeaKQzunI2DOKjU4hBpHYbcVGjAxke9SIklbMP4VUjkGQfepWfMfXjFWdK0G71Rt6qIoAcGWQcH6Dv/nmgDJniMsHygs2/AAGSc1ctfCeq3C7nhW3TGd07BcD6df0qHU9c/sO9ms9HfHlna9y4DF26Hb2UDpWF/a2q+IdWWwnupXtYyJLpSflI67cDsePz9jVAdnD4c0y3tBeX+oeZD/CIVwJPZSeSPfGPeqGpXwu/lgiitrdT8kcagfmcZz7mo7u6eeQtK+T0qiWLHjrSEZ9zBJy5IIAJNU5YHOAUJPsK15I1Kjc2fUetRtGHbc3zE9zTGYclk7gfIw/CmnT5N3KY+vFbzJH0Kr7cVGsOyZmBHIxgDpRcDLtNGErgPOkY7sQzY/75BruvDWjwRzDbrF2V6hLZZFz9cgY/LmufEeTyx6VZtZpreQPC7KwOcg4oEevWZIgCb532j70owT+PGa4nXvBt3PqE9zaNAUmYvsZtrZJyRzx696NN8UX8JHnuJU/2jjj61rnxnaeZ5c0DMg/iUA/oaBWaODvfD+p2IJuLNkXpngj/AL6HFUDYy4+7Xs9v9kvIRNbOrRyDtyrexHSs698JafdZeNTbyn+KI8fip4/LFAXPLE01zneQKka1gVAmcHPXNdReeDtUh3FDHcRjnKNgkfQ/0zXN6hbvbSbJYXjf0dSp/WkMrNppP3XB+tRjS5CcFlqSJyOQ5FTA5/5a0xkSaR/fm7dhU66Xajl5GP40hMeMtJn8aN0Gfv0AWEtNOj/hDH3NFQCWD+6TRRYLGm7DbgDoKZE45GO9NZj/AHu1Rx5Lbc9TipAuWgjLGWVd0aH7nTefTPp607VNXuJLd3eT7q4RF4C8cAD0qKUiMLCGyF6kdzWXq7n7GUBwWYf40Ac3cXKwwSzueFBY571reGrf7PpBmf8A1kzlnP0JH88n8a5TxBdpFDaWobJmlBYf7Kncf5Cut0eXzNDsTn/lip/HFX0AtySc+1M3fN0/Ko3bnGccdhRk7v4fpSAcT9frTTNx0AzQxwOcehpvyDr19qBiiUt6UuTjoc0m9Qo5zjtTlnAwcZNAh657ipFfDZAzVeOVnY7gAPSldsAHoM0ATGdxwKesnOCT+FZrTZ6dKFnBxQBuWepXNlJvglKfTiuqsPGsqbVvIfMHTfHwfrjof0rgBcqNp68VItymQKLCsewWeu2F9gQ3CMx/hPyn9asXFlbXsTRzwo6HqrDIP4V44Llf4Tg+tdLpXi+6swqyyCeH0c8j6GgXL2NHVfAUJDy6c209fJc8H6N2/HP1FcXc2M1lcNDdWrxuvZ/88/WvWdK1uz1aLdBIN4A3RnqtS6jpltqVv5VzHu7qw4ZT6g9qATtueOZAX/U8+tODHtAKv6/pN9od15TNvhf/AFUgHUf0IrG+0XI4G6gZcDSKfltx+VFUhd3HHLZooGbBfBx7UtqMSPIRwnT61XF1BjPmJx/t1JBIJYGKsCC3+FICVnyfmOKxdfBeKAZIXcSR6/5NaUr7ZIj2qjqiCaaFX4jGWY56AUAeZeI5SNZePP8Ax7WTsfYt/wDrFehaET/YNlx/yyUfpXk95enUG1e87XEiInsN3A/ICvWdK/d6TbqeygD8qpiRYYkMW9aaGPUA8+1OkOQMd6jUkD6GkUSLjOPWm4GD0phcsaYZMH8aBEhZdvPXHpQMD5iBUe4IuQegqNnLY2dKAJ0YseD+FNnYk9eKdCNsZbqfeophjrk80AVt2OtL5hLHZUcjbBSxZK8etMCQM/b09amBATPQUkaZx8vNSkYGcUgIxIAOtG8sc7sAH1qB5CDx096kjG7Ge9AGjp+p3Gn3KzwSskg6Ed/rXrWga/DrVksikLKow6E9D6/SvGWHlrWjompyWF6sqFlweSvpRsJq563rulprGmS2p2iQjdGx/hYdP8D7GvIJ4biGZonOxkYqyNwQfSvXNN1+1vLeEvIivISoUHOSK4XxfaeT4jnIXiULIuPcAH9QaBI5gecP4xRVoWxxnaaKCzzXw1qUUO+BoZpWmdnjAHUV3VleyKtmJYjCJiylX9c8fyrz3wmmy9sHnBVUjkUlu3zV22tXMJsoLm1dZPIfOR2brTe5KNx2yQSeBXLeLta8nQr+WI/PIRbx49CMsfyrVvbzdZ+dEfkkQMMe4rgPEU5m0xYc58pSx/3mOf5BaENnOxKRo6AD/WXK/wAjXsNmSLOBf9gV49Af9E06LAy85f8ADIH+NetW8mYYjnsKbFEvbsgE44FN3FB8tMV8J68VHLJtOakZIZAPakz83QZzzVdZcx496mOMZGOtACSEkZBHNIh+YbelJkANiliO6UgdeKALYj+RfTGTUdwoH86sqOpHHAFVbvliDQBlzP8AMBxg1oWyfL7+1ZzZafA6Vq2oI7H2oAsKgjQs/wCHNVGukc7M5NR6jcEQFfwrKtGJuAP7xoA0JyNwweMVet1/db+KzrjKzhAOta6LthVTxnmgCDyzLJ7VXunNo8Oz5mc7VUdSakuLkW0TuTjAyay7KeS7upJ3+8PlQf3RQB7F4c0/y9M0y4Zy77S7ZXHJPP8ALr7CoPiBE0QsbxEBHzRsfyK/+zVFpesq93Bp0QDCGBQOxyoyevXBz/k1seL4pLnwzceWMvHtdOPRsH9GoJ6nmZvZz0QUVFsuz2FFBZ4SdQvJDzcSn/gdek+G1N14Hwcswckk15VmvWvh4huPCtzGedjNx+X/ANerZmh1jcmbQvKc/NA5iP06j/PtXH6hKZF1IH+GRkHHooH9K6e1U22qXdowwJ0yB6lef5ZrN8TaSuj3EfkJLM91BHPOCPljlcFgv/fJU8980kUzmreMPq1lbj7kCAN/vdT+pr063f8AdoM4HpXn1jb/APE+d8Zwq/yHNd1byY4zQwRqA/ugT1wKrSuDIOO9N83Ceo7CoixDAcYJqRj0GByaulgFwCBVLawHGPWnKc559KAJjjB/vfzpbc7pDzjmoZZDsFFicyjPNMDbT5h7dao3YAdqvw/6rPNZ1+c7qQGan+uznArVtjlaykb5ue9aNqx2k9xTAqX53ZOMYrNspQdUiQetX9SOFP8AePWsDRH83xAvsT+goQjpwnn6luwdoP51qTuEUnjiqNphHeZz06Vn32o5fg53HAFIZma7qRM62sRy7cvWhpSiCEMf4eTXLWRe/wBQknJzly2fauozshx70xHUeDrhn8SQSFj8z7Dz2PB/ma9UZHutKmiHJEckRBycnbx+orxnw4xi1S3YjOGBx617Ppjn+0b+3bGNyShcdmXB+vIpAzwseOLZMfu0/wC+6K8o1u2NnrV9arwILiSLGemGI/pRVcpPOZ0YUv8AN92vWPhZOh0q/QD7si8fga8jr0j4YT7DqSdfkVsfiabEty/4gRrS/W5j6wvu+ormNP1rULuyurOaUvFJJHK7yctlFKoM+gDHj6V2Pi8RW2jXN5cAFnbyok6bm6k/QDH4ke9ed6MvmNeAdcK36/8A16S2G9zprEwLFHxiQjk1sowIHPArk47jy7tUzxtFdBFNlRmgZrs/y8dqEJbnFQpIAmC+c9qeJFH0pFE0jADHANV45QXHOcmoJpsLxVe3lzIDnvQBq3BwnPPFOsTh+nSobkjyl5yKmsiS/fqM5oA6CDiAfTpWPfk7jn68VsJxb9eMGsO6YmQjOSelICpASWOa04CQoz61mxByc5Aq9BJ0XrTYFTVCNrVzXhd/M1+Qk9A1dBqeDkdK5XwlLjW7s9eCv60dBM6q9vlgjk3vhR8xrn5JZYtPur+44dlIjX+6DwKh8S3phkRwfuqSg96gvbiW+WwsXIMjYklx7U0Bp6Db+VYI7gBjWsC8h46A1Cse2JIk4AGKtxw7Mc0gNTQ2RdSty3Zl7Z717BpTyrrcqMo8sxkK+7JOCMcfrXisDeVIp9PSvT/CV/JOYndlcKQpPQjIA6dxzS6gz5s8d2pi8e69Ht2qL6Y4x/tmiuw8c600PjfWIhp+mzkXLhhJ9/hj3oqybHlJQjHvXefC0NJq15AoyzxDA9eaKKHsJbnqviHw5Yarog0+RCUTLI46hu5FeSw+Hrvw5rZiuMNaTxmNJgODnp9DkUUVKKMO7doNZlQ/w/Lj+7W7YXQKqDkg0UVoJGzFKHIx+pqdp/lIA5oorNlGfdTnufrTLNsz+1FFMRtSkG3HHarFkdrnI5zRRSKRuscWg9MVhXDEux5oopAM6ICKliODxjFFFMCte4OeO1cLo832XXp06ZYiiimhMs+KY/M+y3A+4r4b8cf4UmhKbnUJ7kjPzbF9looq+gup2EMDkBzVjaycDrRRWRQ6JCxGcfjXpngVUSxlJccMCFVuOOelFFDF0PCvjJZfYfidqwQYScxzp77kXP6g0UUVaIP/2Q==","type":1,"state":1,"origin":0,"tags":[{"$oid":"5cd447d79865305588453109"}],"comments":[],"category":[{"$oid":"5cd44852986530558845310a"}],"title":"react-hooks","author":"james","content":"## 1. React Hooks\nHook 是 React 16.8 的新增特性。它可以让你在不编写 class 的情况下使用 state 以及其他的\nReact 特性\n如果你在编写函数组件并意识到需要向其添加一些 state，以前的做法是必须将其它转化为\nclass。现在你可以在现有的函数组件中使用 Hook\n## 2. 解决的问题\n在组件之间复用状态逻辑很难,可能要用到render props和高阶组件，React 需要为共享状态逻\n辑提供更好的原生途径，Hook 使你在无需修改组件结构的情况下复用状态逻辑\n复杂组件变得难以理解，Hook 将组件中相互关联的部分拆分成更小的函数（比如设置订阅或\n请求数据）\n难以理解的 class,包括难以捉摸的 this\n## 3. 注意事项\n只能在函数最外层调用 Hook。不要在循环、条件判断或者子函数中调用。\n只能在 React 的函数组件中调用 Hook。不要在其他 JavaScript 函数中调用\n## 4. useState\nuseState 就是一个 Hook\n通过在函数组件里调用它来给组件添加一些内部 state,React 会在重复渲染时保留这个 state\nuseState 会返回一对值：当前状态和一个让你更新它的函数，你可以在事件处理函数中或其他\n一些地方调用这个函数。它类似 class 组件的 this.setState，但是它不会把新的 state 和旧的\nstate 进行合并\nuseState 唯一的参数就是初始 state\n返回一个 state，以及更新 state 的函数\n在初始渲染期间，返回的状态 (state) 与传入的第一个参数 (initialState) 值相同\nsetState 函数用于更新 state。它接收一个新的 state 值并将组件的一次重新渲染加入队列\n```\nconst [state, setState] = useState(initialState);\n```\n### 4.1 计数器\n```\nimport React,{useState} from 'react';\n2019/5/9 1. React Hooks\nhttps://maxiang.io/ 2/13\nclass Counter extends React.Component {\nconstructor(props) {\nsuper(props);\nthis.state = {\nnumber: 0\n};\n}\nrender() {\nreturn (\n);\n}\n}\nfunction Counter2(){\nconst [number,setNumber] = useState(0);\nreturn (\n\u003cdiv\u003e\n          \u003cp\u003e{number}\u003c/p\u003e\n          \u003cbutton onClick={()=\u003esetNumber(number+1)}\u003e+\u003c/button\u003e\n \u003c/div\u003e\n)\n```\n### 4.2 每次渲染都是独立的闭包\n每一次渲染都有它自己的 Props and State\n每一次渲染都有它自己的事件处理函数\nalert会“捕获”我点击按钮时候的状态。\n我们的组件函数每次渲染都会被调用，但是每一次调用中number值都是常量，并且它被赋予了\n当前渲染中的状态值\n在单次渲染的范围内，props和state始终保持不变\n\n```\nfunction Counter2(){\nconst [number,setNumber] = useState(0);\nfunction alertNumber(){\nsetTimeout(()=\u003e{\nalert(number);\n},3000);\n}\nreturn (\n    \u003cdiv\u003e\n          \u003cp\u003e{number}\u003c/p\u003e\n          \u003cbutton onClick={()=\u003esetNumber(number+1)}\u003e+\u003c/button\u003e\n     \u003c/div\u003e\n)\n\u003cdiv\u003e\n\u003cp\u003e{this.state.number}\u003c/p\u003e\n\u003cbutton onClick={() =\u003e this.setState({ number: this.state.n\number + 1 })}\u003e\n+\n\u003c/button\u003e\n\u003c/div\u003e\n\u003c\u003e\n\u003cp\u003e{number}\u003c/p\u003e\n\u003cbutton onClick={()=\u003esetNumber(number+1)}\u003e+\u003c/button\u003e\n\u003c/\u003e\n)\n}\nexport default Counter2;\n```\n### 4.3 函数式更新\n如果新的 state 需要通过使用先前的 state 计算得出，那么可以将函数传递给 setState。该函\n数将接收先前的 state，并返回一个更新后的值\n```\nfunction Counter2(){\nconst [number,setNumber] = useState(0);\nlet numberRef = useRef(number);\nnumberRef.current = number;\nfunction alertNumber(){\nsetTimeout(()=\u003e{\nalert(numberRef.current);\n},3000);\n}\n+ function lazy(){\n+ setTimeout(()=\u003e{\n+ setNumber(number+1);\n+ },3000);\n+ }\n+ function lazyFunc(){\n+ setTimeout(()=\u003e{\n+ setNumber(number=\u003enumber+1);\n+ },3000);\n+ }\nreturn (\n\u003c\u003e\n\u003cp\u003e{number}\u003c/p\u003e\n\u003cbutton onClick={()=\u003esetNumber(number+1)}\u003e+\u003c/button\u003e\n\u003cbutton onClick={lazy}\u003elazy+\u003c/button\u003e\n\u003cbutton onClick={lazyFunc}\u003elazyFunc+\u003c/button\u003e\n\u003cbutton onClick={alertNumber}\u003ealertNumber\u003c/button\u003e\n\u003c/\u003e\n)\n}\n```\n### 4.4 惰性初始 state\ninitialState 参数只会在组件的初始渲染中起作用，后续渲染时会被忽略\n```\n\u003cp\u003e{number}\u003c/p\u003e\n\u003cbutton onClick={()=\u003esetNumber(number+1)}\u003e+\u003c/button\u003e\n\u003cbutton onClick={alertNu\n如果初始 state 需要通过复杂计算获得，则可以传入一个函数，在函数中计算并返回初始的\nstate，此函数只在初始渲染时被调用\n与 class 组件中的 setState 方法不同，useState 不会自动合并更新对象。你可以用函数式的\nsetState 结合展开运算符来达到合并更新对象的效果\nfunction Counter3(){\nconst [{name,number},setValue] = useState(()=\u003e{\nreturn {name:'计数器',number:0};\n});\nreturn (\n\u003cdiv\u003e\n\u003cp\u003e{name}:{number}\u003c/p\u003e\n\u003cbutton onClick={()=\u003esetValue({number:number+1})}\u003e+\u003c/button\u003e\n\u003c/div\u003e\n)\n```\n### 4.5 性能优化\n#### 4.5.1 Object.is\n调用 State Hook 的更新函数并传入当前的 state 时，React 将跳过子组件的渲染及 effect 的执\n行。（React 使用 Object.is 比较算法 来比较 state。）\n```\nfunction Counter4(){\nconst [counter,setCounter] = useState({name:'计数器',number:0});\nconsole.log('render Counter')\nreturn (\n\u003cdiv\u003e\n\u003cp\u003e{counter.name}:{counter.number}\u003c/p\u003e\n\u003cbutton onClick={()=\u003esetCounter({...counter,number:counter.numb\ner+1})}\u003e+\u003c/button\u003e\n\u003cbutton onClick={()=\u003esetCounter(counter)}\u003e-\u003c/button\u003e\n\u003c/div\u003e\n)\n```\n#### 4.5.2 减少渲染次数\n把内联回调函数及依赖项数组作为参数传入 useCallback ，它将返回该回调函数的\nmemoized 版本，该回调函数仅在某个依赖项改变时才会更新\n把创建函数和依赖项数组作为参数传入 useMemo ，它仅会在某个依赖项改变时才重新计算\nmemoized 值。这种优化有助于避免在每次渲染时都进行高开销的计算\n\n```\nfunction Child({onButtonClick,data}){\n\u003cdiv\u003e\n\u003cp\u003e{name}:{number}\u003c/p\u003e\n\u003cbutton onClick={()=\u003esetValue({number:number+1})}\u003e+\u003c/button\u003e\n\u003c/div\u003e\n)\n}\n\u003cdiv\u003e\n\u003cp\u003e{counter.name}:{counter.number}\u003c/p\u003e\n\u003cbutton onClick={()=\u003esetCounter({...counter,number:counter.numb\ner+1})}\u003e+\u003c/button\u003e\n\u003cbutton onClick={()=\u003esetCounter(counter)}\u003e-\u003c/button\u003e\n\u003c/div\u003e\n)\n}\nconsole.log('Child render');\nreturn (\n)\n}\nChild = memo(Child);\nfunction App(){\nconst [number,setNumber] = useState(0);\nconst [name,setName] = useState('zhufeng');\nconst addClick = useCallback(()=\u003esetNumber(number+1),[number]);\nconst data = useMemo(()=\u003e({number}),[number]);\nreturn (\n\u003cdiv\u003e\n\u003cinput type=\"text\" value={name} onChange={e=\u003esetName(e.target.valu\ne)}/\u003e\n\u003cChild onButtonClick={addClick} data={data}/\u003e\n\u003c/div\u003e\n)\n}\n```\n## 5. useReducer\nuseState 的替代方案。它接收一个形如 (state, action) =\u003e newState 的 reducer，并返回当前\n的 state 以及与其配套的 dispatch 方法\n在某些场景下，useReducer 会比 useState 更适用，例如 state 逻辑较复杂且包含多个子值，\n或者下一个 state 依赖于之前的 state 等\n```\nconst [state, dispatch] = useReducer(reducer, initialArg, init);\nconst initialState = 0;\nfunction reducer(state, action) {\nswitch (action.type) {\ncase 'increment':\nreturn {number: state.number + 1};\ncase 'decrement':\nreturn {number: state.number - 1};\ndefault:\nthrow new Error();\n}\n}\nfunction init(initialState){\nreturn {number:initialState};\n}\nfunction Counter(){\nconst [state, dispatch] = useReducer(reducer, initialState,init);\nreturn (\n\u003cbutton onClick={onButtonClick} \u003e{data.number}\u003c/button\u003e\n```\n## 6. useContext\n接收一个 context 对象（React.createContext 的返回值）并返回该 context 的当前值\n当前的 context 值由上层组件中距离当前组件最近的 \u003cMyContext.Provider\u003e 的 value prop 决\n定\n当组件上层最近的 \u003cMyContext.Provider\u003e 更新时，该 Hook 会触发重渲染，并使用最新传递\n给 MyContext provider 的 context value 值\nuseContext(MyContext) 相当于 class 组件中的 static contextType = MyContext 或者\n\u003cMyContext.Consumer\u003e\nuseContext(MyContext) 只是让你能够读取 context 的值以及订阅 context 的变化。你仍然需要\n在上层组件树中使用 \u003cMyContext.Provider\u003e 来为下层组件提供 context\n```\nconst CounterContext = React.createContext();\nfunction reducer(state, action) {\nswitch (action.type) {\ncase 'increment':\nreturn {number: state.number + 1};\ncase 'decrement':\nreturn {number: state.number - 1};\ndefault:\nthrow new Error();\n}\n}\nfunction Counter(){\nlet {state,dispatch} = useContext(CounterContext);\nreturn (\n\u003c\u003e\n\u003cp\u003e{state.number}\u003c/p\u003e\n\u003cbutton onClick={() =\u003e dispatch({type: 'increment'})}\u003e+\u003c/button\u003e\n\u003cbutton onClick={() =\u003e dispatch({type: 'decrement'})}\u003e-\u003c/button\u003e\n\u003c/\u003e\n)\n}\nfunction App(){\nconst [state, dispatch] = useReducer(reducer, {number:0});\nreturn (\n\u003c\u003e\nCount: {state.number}\n\u003cbutton onClick={() =\u003e dispatch({type: 'increment'})}\u003e+\u003c/button\n\u003e\n\u003cbutton onClick={() =\u003e dispatch({type: 'decrement'})}\u003e-\u003c/button\n\u003e\n\u003c/\u003e\n)\n}\n\n\u003cCounterContext.Provider value={{state,dispatch}}\u003e\n\u003cCounter/\u003e\n\u003c/CounterContext.Provider\u003e\n)\n}\n```\n## 7. effect\n在函数组件主体内（这里指在 React 渲染阶段）改变 DOM、添加订阅、设置定时器、记录日\n志以及执行其他包含副作用的操作都是不被允许的，因为这可能会产生莫名其妙的 bug 并破坏\nUI 的一致性\n使用 useEffect 完成副作用操作。赋值给 useEffect 的函数会在组件渲染到屏幕之后执行。你\n可以把 effect 看作从 React 的纯函数式世界通往命令式世界的逃生通道\nuseEffect 就是一个 Effect Hook，给函数组件增加了操作副作用的能力。它跟 class 组件中的\ncomponentDidMount 、 componentDidUpdate 和 componentWillUnmount 具有相同的用\n途，只不过被合并成了一个 API\n该 Hook 接收一个包含命令式、且可能有副作用代码的函数\nuseEffect(didUpdate);\n### 7.1 通过class实现修标题\n```\nclass Counter extends React.Component {\nconstructor(props) {\nsuper(props);\nthis.state = {\nnumber: 0\n};\n}\ncomponentDidMount() {\ndocument.title = `你点击了${this.state.number}次`;\n}\ncomponentDidUpdate() {\ndocument.title = `你点击了${this.state.number}次`;\n}\n}\n```\n在这个 class 中，我们需要在两个生命周期函数中编写重复的代码,这是因为很多情况下，\n我们希望在组件加载和更新时执行同样的操作。我们希望它在每次渲染之后执行，但\nReact 的 class 组件没有提供这样的方法。即使我们提取出一个方法，我们还是要在两个地\n方调用它。useEffect会在第一次渲染之后和每次更新之后都会执行\n###  7.2 通过effect实现\n```\nimport React,{Component,useState,useEffect} from 'react';\nimport ReactDOM from 'react-dom';\nfunction Counter(){\nconst [number,setNumber] = useState(0);\n// 相当于 componentDidMount 和 componentDidUpdate:\nuseEffect(() =\u003e {\n// 使用浏览器的 API 更新页面标题\ndocument.title = `你点击了${number}次`;\n});\nreturn ()\n```\n每次我们重新渲染，都会生成新的 effect，替换掉之前的。某种意义上讲，effect 更像是渲\n染结果的一部分 —— 每个 effect 属于一次特定的渲染。\n### 7.3 清除副作用\n副作用函数还可以通过返回一个函数来指定如何清除副作用\n为防止内存泄漏，清除函数会在组件卸载前执行。另外，如果组件多次渲染，则在执行下一个\neffect 之前，上一个 effect 就已被清除\n```\n\u003cbutton onClick={() =\u003e this.setState({ number: this.state.numbe\nr + 1 })}\u003e\n+\n\u003c/button\u003e\n\u003c/div\u003e\n\u003c\u003e\n\u003cp\u003e{number}\u003c/p\u003e\n\u003cbutton onClick={()=\u003esetNumber(number+1)}\u003e+\u003c/button\u003e\n\u003c/\u003e\n)\n}\nReactDOM.render(\u003cCounter /\u003e, document.getElementById('root'));\n\nfunction Counter(){\nconst [number,setNumber] = useState(0);\n// 相当于componentDidMount 和 componentDidUpdate\nuseEffect(() =\u003e {\nconsole.log('开启一个新的定时器')\nconst $timer = setInterval(()=\u003e{\nsetNumber(number=\u003enumber+1);\n},1000);\nreturn ()=\u003e{\nconsole.log('销毁老的定时器');\nclearInterval($timer);\n}\n});\nreturn ()\n```\n### 7.4 跳过 Effect 进行性能优化\n如果某些特定值在两次重渲染之间没有发生变化，你可以通知 React 跳过对 effect 的调用，只\n要传递数组作为 useEffect 的第二个可选参数即可\n如果想执行只运行一次的 effect（仅在组件挂载和卸载时执行），可以传递一个空数组（[]）作\n为第二个参数。这就告诉 React 你的 effect 不依赖于 props 或 state 中的任何值，所以它永远\n都不需要重复执行\n```\nfunction Counter(){\nconst [number,setNumber] = useState(0);\n// 相当于componentDidMount 和 componentDidUpdate\nuseEffect(() =\u003e {\nconsole.log('开启一个新的定时器')\nconst $timer = setInterval(()=\u003e{\nsetNumber(number=\u003enumber+1);\n},1000);\n},[]);\nreturn (\n### 7.5 useRef\n\u003c\u003e\n\u003cp\u003e{number}\u003c/p\u003e\n\u003c/\u003e\n)\n}\n\u003c\u003e\n\u003cp\u003e{number}\u003c/p\u003e\n\u003c/\u003e\n)\n}\n```\nuseRef 返回一个可变的 ref 对象，其 .current 属性被初始化为传入的参数（initialValue）\n返回的 ref 对象在组件的整个生命周期内保持不变\n```const refContainer = useRef(initialValue);```\n\n#### 7.5.1 useRef\n```\nfunction Parent(){\nlet [number,setNumber] = useState(0);\nreturn (\n\u003c\u003e\n\u003cChild/\u003e\n\u003cbutton onClick={()=\u003esetNumber({number:number+1})}\u003e+\u003c/button\u003e\n\u003c/\u003e\n)\n}\nlet input;\nfunction Child(){\nconst inputRef = useRef();\nconsole.log('input===inputRef',input===inputRef);\ninput = inputRef;\nfunction getFocus(){\ninputRef.current.focus();\n}\nreturn (\n\u003c\u003e\n\u003cinput type=\"text\" ref={inputRef}/\u003e\n\u003cbutton onClick={getFocus}\u003e获得焦点\u003c/button\u003e\n\u003c/\u003e\n)\n}\n```\n####  7.5.2 forwardRef\n将ref从父组件中转发到子组件中的dom元素上\n子组件接受props和ref作为参数\n```\nfunction Child(props,ref){\nreturn (\n\u003cinput type=\"text\" ref={ref}/\u003e\n)\n}\nChild = forwardRef(Child);\nfunction Parent(){\nlet [number,setNumber] = useState(0);\nconst inputRef = useRef();\nfunction getFocus(){\ninputRef.current.value = 'focus';\ninputRef.current.focus();\n}\nreturn (\n\u003c\u003e\n\u003cChild ref={inputRef}/\u003e\n\u003cbutton onClick={()=\u003esetNumber({number:number+1})}\u003e+\u003c/button\u003e\n\u003cbutton onClick={getFocus}\u003e获得焦点\u003c/button\u003e\n\u003c/\u003e\n)\n}\n```\n#### 7.5.3 useImperativeHandle\nuseImperativeHandle 可以让你在使用 ref 时自定义暴露给父组件的实例值\n在大多数情况下，应当避免使用 ref 这样的命令式代码。useImperativeHandle 应当与\nforwardRef 一起使用\n```\nfunction Child(props,ref){\nconst inputRef = useRef();\nuseImperativeHandle(ref,()=\u003e(\n{\nfocus(){\ninputRef.current.focus();\n}\n}\n));\nreturn (\n\u003cinput type=\"text\" ref={inputRef}/\u003e\n)\n}\nChild = forwardRef(Child);\nfunction Parent(){\nlet [number,setNumber] = useState(0);\nconst inputRef = useRef();\nfunction getFocus(){\nconsole.log(inputRef.current);\ninputRef.current.value = 'focus';\ninputRef.current.focus();\n}\nreturn (\n\u003c\u003e\n\u003cChild ref={inputRef}/\u003e\n\u003cbutton onClick={()=\u003esetNumber({number:number+1})}\u003e+\u003c/button\u003e\n\u003cbutton onClick={getFocus}\u003e获得焦点\u003c/button\u003e\n\u003c/\u003e\n)\n}\n```\n## 8. useLayoutEffect\n其函数签名与 useEffect 相同，但它会在所有的 DOM 变更之后同步调用 effect\n可以使用它来读取 DOM 布局并同步触发重渲染\n在浏览器执行绘制之前useLayoutEffect内部的更新计划将被同步刷新\n尽可能使用标准的 useEffect 以避免阻塞视图更新\n```\nfunction LayoutEffect() {\nconst [color, setColor] = useState('red');\nuseLayoutEffect(()=\u003e{\nalert(color);\ndocument.getElementById('myDiv').style.background = 'purple';\n});\nuseEffect(()=\u003e{\nconsole.log('color',color);\n});\nreturn ()\n```\n## 9. 自定义 Hook\n有时候我们会想要在组件之间重用一些状态逻辑\n自定义 Hook 可以让你在不增加组件的情况下达到同样的目的\nHook 是一种复用状态逻辑的方式，它不复用 state 本身\n事实上 Hook 的每次调用都有一个完全独立的 state\n```\nfunction useNumber(){\nconst [number,setNumber] = useState(0);\nuseEffect(() =\u003e {\nconsole.log('开启一个新的定时器')\nconst $timer = setInterval(()=\u003e{\nsetNumber(number+1);\n},1000);\nreturn ()=\u003e{\nconsole.log('销毁老的定时器')\nclearInterval($timer);\n}\n});\nreturn number;\n\u003c\u003e\n\u003cdiv id=\"myDiv\" style={{background:color}}\u003e颜色\u003c/div\u003e\n\u003cbutton onClick={()=\u003esetColor('red')}\u003e红\u003c/button\u003e\n\u003cbutton onClick={()=\u003esetColor('yellow')}\u003e黄\u003c/button\u003e\n\u003cbutton onClick={()=\u003esetColor('blue')}\u003e蓝\u003c/button\u003e\n\u003c/\u003e\n);\n}\n}\nfunction Counter1(){\nlet number1 = useNumber();\nreturn ()\n```\n## 10.附录\n### 10.1 浏览器是如何呈现一张页面的\n解析HTML，并生成一棵DOM tree\n解析各种样式并结合DOM tree生成一棵Render tree\n对Render tree的各个节点计算布局信息，比如box的位置与尺寸\n根据并利用浏览器的UI层进行绘制","like_users":[],"create_time":{"$date":"2019-05-09T14:43:48.988Z"},"update_time":{"$date":"2019-05-09T14:43:48.988Z"},"id":1,"__v":0}
{"_id":{"$oid":"5ce6ba3f1dddd92f8c79baee"},"meta":{"views":15,"likes":0,"comments":0},"keyword":["james"],"desc":"交互专家","numbers":"9","img_url":"data:image/jpeg;base64,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","type":1,"state":1,"origin":0,"tags":[{"$oid":"5cd447d79865305588453109"}],"comments":[],"category":[{"$oid":"5ce15a8ce5f4657c14c9805c"}],"title":"关于我","author":"golderBrother","content":"\u003cdiv class=\"content\"\u003e\u003cdiv id=\"content\" class=\"article-detail\"\u003e\u003ch1 id=\"#toc11\"\u003e网站简介\u003c/h1\u003e\n\u003cp\u003e我的个人技术博客地址，不定期更新有价值的内容 \u003ca href=\"https://golderBrother.cn\"\u003egolderBrother 的个人博客网站(还在开发当中哈~)\u003c/a\u003e。\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://upload-images.jianshu.io/upload_images/12890819-af8dcbb956319a4c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"\"\u003e\u003c/p\u003e\n\u003ch1 id=\"#toc12\"\u003e活跃Github\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/GolderBrother\"\u003egithub\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1 id=\"#toc13\"\u003e关于我\u003c/h1\u003e\n\u003cp\u003e本人姓名： 张耀煌 ，常用昵称是：神哥(来源于英雄联盟的疯狂时期emm~~~)，然后英文名有两个就是 GolderBrother或者jamesZhang，现在从事 前端开发，一枚软件开发攻城狮～\u003c/p\u003e\n\n\n\u003cp\u003e技术栈相关：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cp\u003e前端：javaScript、vue.js、react.js、angular.js；\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e后端：对 node.js、 java、MySql、MongoDB 等也略有接触 ；\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e业余爱折腾：跑步、健身、电影，音乐、写字；\u003c/p\u003e\n\n\u003cp\u003e邮箱：\u003cstrong\u003e1204788939#qq.com\u003c/strong\u003e ，将 \u003cstrong\u003e#\u003c/strong\u003e 号换成 \u003cstrong\u003e@\u003c/strong\u003e 即可。\u003c/p\u003e\n\n\u003c/div\u003e\u003c/div\u003e","like_users":[],"create_time":{"$date":"2019-05-23T15:20:31.821Z"},"update_time":{"$date":"2019-05-23T15:20:31.821Z"},"id":2,"__v":0}
{"_id":{"$oid":"5cf9393bb1911633f44b374a"},"meta":{"views":22,"likes":0,"comments":0},"keyword":["网站的性能优化"],"desc":"一次网站的性能优化之路 -- 天下武功，唯快不破","numbers":"19070","img_url":"data:image/jpeg;base64,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","type":1,"state":1,"origin":0,"tags":[{"$oid":"5cd447d79865305588453109"}],"comments":[],"category":[{"$oid":"5cd44852986530558845310a"}],"title":"一次网站的性能优化之路 -- 天下武功，唯快不破","author":"golderBrother","content":"\u003cdiv class=\"content\"\u003e\u003cdiv id=\"content\" class=\"article-detail\"\u003e\u003cp\u003e\u003cimg src=\"https://upload-images.jianshu.io/upload_images/12890819-c6ef743c696cd696.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003e首屏作为直面用户的第一屏，其重要性不言而喻，如何加快加载的速度是非常重要的一课。\u003c/p\u003e\n\u003cp\u003e本文讲解的是：笔者对自己搭建的个人博客网站的速度优化的经历。\u003c/p\u003e\n\u003cp\u003e效果体验地址：\u003ca href=\"http://localhost:3001\"\u003e http://localhost:3001\u003c/a\u003e\u003c/p\u003e\n\u003ch1 id=\"#toc11\"\u003e1. 用户期待的速度体验\u003c/h1\u003e\n\u003cp\u003e2018 年 8 月，百度搜索资源平台发布的《百度移动搜索落地页体验白皮书 4.0 》中提到：\u003cstrong\u003e页面的首屏内容应在 1.5 秒内加载完成\u003c/strong\u003e。\u003c/p\u003e\n\u003cp\u003e也许有人有疑惑：为什么是 1.5 秒内？哪些方式可加快加载速度？以下将为您解答这些疑问！\u003c/p\u003e\n\u003cp\u003e移动互联网时代，用户对于网页的打开速度要求越来越高。百度用户体验部研究表明，页面放弃率和页面的打开时间关系如下图所示：\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://upload-images.jianshu.io/upload_images/12890819-6fc8794f8694acfb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"页面放弃率和页面的打开时间关系\"\u003e\u003c/p\u003e\n\u003cp\u003e根据百度用户体验部的研究结果来看，普通用户期望且能够接受的页面加载时间在 3 秒以内。若页面的加载时间过慢，用户就会失去耐心而选择离开，这对用户和站长来说都是一大损失。\u003c/p\u003e\n\u003cp\u003e百度搜索资源平台有 “闪电算法” 的支持，为了能够保障用户体验，给予优秀站点更多面向用户的机会，“闪电算法”在 2017 年 10 月初上线。\u003c/p\u003e\n\u003cp\u003e闪电算法 的具体内容如下：\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003e移动网页首屏在 2 秒之内完成打开的，在移动搜索下将获得提升页面评价优待，获得流量倾斜；同时，在移动搜索页面首屏加载非常慢（3 秒及以上）的网页将会被打压。\u003c/strong\u003e\u003c/p\u003e\n\u003ch1 id=\"#toc12\"\u003e2. 分析问题\u003c/h1\u003e\n\u003cp\u003e未优化之前，首屏时间居然大概要 7 - 10 秒，简直不要太闹心。\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://upload-images.jianshu.io/upload_images/12890819-6b4894c8ee6020a6.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://upload-images.jianshu.io/upload_images/12890819-e9cb985bca8efcd3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003e开始分析问题，先来看下 network ：\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://upload-images.jianshu.io/upload_images/12890819-d6730f25f400cc7a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003e主要问题：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003e第一个文章列表接口用了 4.42 秒\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e其他的后端接口速度也不快\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e另外 js css 等静态的文件也很大，请求的时间也很长\u003c/strong\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e我还用了 Lighthouse 来测试和分析我的网站。\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eLighthouse 是一个开源的自动化工具，用于改进网络应用的质量。 你可以将其作为一个 Chrome 扩展程序运行，或从命令行运行。 为 Lighthouse 提供一个需要审查的网址，它将针对此页面运行一连串的测试，然后生成一个有关页面性能的报告。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e未优化之前：\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://upload-images.jianshu.io/upload_images/12890819-c427ff2fd6c23bec.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e上栏内容分别是页面性能、PWA（渐进式 Web 应用）、可访问性（无障碍）、最佳实践、SEO 五项指标的跑分。\u003c/p\u003e\n\u003cp\u003e下栏是每一个指标的细化性能评估。\u003c/p\u003e\n\u003cp\u003e再看下 Lighthouse 对性能问题给出了可行的建议、以及每一项优化操作预期会帮我们节省的时间：\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://upload-images.jianshu.io/upload_images/12890819-f7a9eb3526a755b8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e从上面可以看出，主要问题：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003e图片太大\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e一开始图片就加载了太多\u003c/strong\u003e \u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e知道问题所在就已经成功了一半了，接下来便开始优化之路。\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://upload-images.jianshu.io/upload_images/12890819-badeaef63e605bfb.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"\"\u003e\u003c/p\u003e\n\u003ch1 id=\"#toc13\"\u003e2. 优化之路\u003c/h1\u003e\n\u003cp\u003e网页速度优化的方法实在太多，本文只说本次优化用到的方法。\u003c/p\u003e\n\u003ch2 id=\"#toc24\"\u003e2.1 前端优化\u003c/h2\u003e\n\u003cp\u003e本项目前端部分是用了 react 和 antd，但是 webpack 用的还是 3.8.X 。\u003c/p\u003e\n\u003ch4 id=\"#toc45\"\u003e2.1.1 webpack 打包优化\u003c/h4\u003e\n\u003cp\u003e因为 webpack4 对打包做了很多优化，比如 Tree-Shaking ，所以我用最新的 react-create-app 重构了一次项目，把项目升级了一遍，所有的依赖包都是目前最新的稳定版了，webpack 也升级到了 4.28.3 。\u003c/p\u003e\n\u003cp\u003e用最新 react-create-app 创建的项目，很多配置已经是很好了的，笔者只修改了两处地方。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003col\u003e\n\u003cli\u003e打包配置修改了 webpack.config.js 的这一行代码：\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"code\"\u003e// Source maps are resource heavy \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e can cause \u003cspan class=\"hljs-keyword\"\u003eout\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eof\u003c/span\u003e memory issue \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e large source files.\nconst shouldUseSourceMap = \u003cspan class=\"hljs-keyword\"\u003eprocess\u003c/span\u003e.env.GENERATE_SOURCEMAP !== \u003cspan class=\"hljs-symbol\"\u003e'false\u003c/span\u003e';\n\n// 把上面的代码修改为： \nconst shouldUseSourceMap = \u003cspan class=\"hljs-keyword\"\u003eprocess\u003c/span\u003e.env.NODE_ENV === \u003cspan class=\"hljs-symbol\"\u003e'production\u003c/span\u003e' ? \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e : \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e;\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e生产环境下，打包去掉 SourceMap，静态文件就很小了，从 13M 变成了 3M 。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003col start=\"2\"\u003e\n\u003cli\u003e还修改了图片打包大小的限制，这样子小于 40K 的图片都会变成 base64 的图片格式。\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"code\"\u003e{\n      \u003cspan class=\"hljs-symbol\"\u003etest:\u003c/span\u003e [\u003cspan class=\"hljs-regexp\"\u003e/\\.bmp$/\u003c/span\u003e, \u003cspan class=\"hljs-regexp\"\u003e/\\.gif$/\u003c/span\u003e, \u003cspan class=\"hljs-regexp\"\u003e/\\.jpe?g$/\u003c/span\u003e, \u003cspan class=\"hljs-regexp\"\u003e/\\.png$/\u003c/span\u003e,\u003cspan class=\"hljs-regexp\"\u003e/\\.jpg$/\u003c/span\u003e,\u003cspan class=\"hljs-regexp\"\u003e/\\.svg$/\u003c/span\u003e],\n      \u003cspan class=\"hljs-symbol\"\u003eloader:\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003erequire\u003c/span\u003e.resolve(\u003cspan class=\"hljs-string\"\u003e'url-loader'\u003c/span\u003e),\n      \u003cspan class=\"hljs-symbol\"\u003eoptions:\u003c/span\u003e {\n            \u003cspan class=\"hljs-symbol\"\u003elimit:\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e40000\u003c/span\u003e, \u003cspan class=\"hljs-regexp\"\u003e//\u003c/span\u003e 把默认的 \u003cspan class=\"hljs-number\"\u003e10000\u003c/span\u003e 修改为 \u003cspan class=\"hljs-number\"\u003e40000\u003c/span\u003e\n            \u003cspan class=\"hljs-symbol\"\u003ename:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'static/media/[name].[hash:8].[ext]'\u003c/span\u003e,\n      },\n }\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"#toc46\"\u003e2.1.2 去掉没用的文件\u003c/h4\u003e\n\u003cp\u003e比如之前可能觉得会有用的文件，后面发现用不到了，注释或者删除，比如 reducers 里面的 home 模块。\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"code\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { combineReducers } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'redux'\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { connectRouter } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'connected-react-router'\u003c/span\u003e\n\u003cspan class=\"hljs-regexp\"\u003e//\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { home } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'./module/home'\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { user } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'./module/user'\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { articles } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'./module/articles'\u003c/span\u003e\n\nconst rootReducer = \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003e(history)\u003c/span\u003e =\u0026gt;\u003c/span\u003e combineReducers({\n \u003cspan class=\"hljs-regexp\"\u003e//\u003c/span\u003e home, \n  user,\n  articles,\n  router: connectRouter(history)\n})\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"#toc47\"\u003e2.1.3 图片处理\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cp\u003e把一些静态文件再用 photoshop 换一种格式或者压缩了一下， 比如 logo 图片，原本 111k，压缩后是 23K。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e首页的文章列表图片，修改为懒加载的方式加载。\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e之前因为不想为了个懒加载功能而引用一个插件，所以想自己实现，看了网上关于图片懒加载的一些代码，再结合本项目，实现了一个图片懒加载功能，加入了 \u003cstrong\u003e事件的节流（throttle）与防抖（debounce）\u003c/strong\u003e。\u003c/p\u003e\n\u003cp\u003e代码如下：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"code\"\u003e\u003cspan class=\"hljs-comment\"\u003e// fn 是事件回调, delay 是时间间隔的阈值\u003c/span\u003e\n\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003ethrottle\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003efn, delay\u003c/span\u003e) \u003c/span\u003e{\n  \u003cspan class=\"hljs-comment\"\u003e// last 为上一次触发回调的时间, timer 是定时器\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e last = \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e,\n    timer = \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e;\n  \u003cspan class=\"hljs-comment\"\u003e// 将throttle处理结果当作函数返回\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) \u003c/span\u003e{\n    \u003cspan class=\"hljs-comment\"\u003e// 保留调用时的 this 上下文\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e context = \u003cspan class=\"hljs-keyword\"\u003ethis\u003c/span\u003e;\n    \u003cspan class=\"hljs-comment\"\u003e// 保留调用时传入的参数\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e args = \u003cspan class=\"hljs-built_in\"\u003earguments\u003c/span\u003e;\n    \u003cspan class=\"hljs-comment\"\u003e// 记录本次触发回调的时间\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e now = +\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eDate\u003c/span\u003e();\n\n    \u003cspan class=\"hljs-comment\"\u003e// 判断上次触发的时间和本次触发的时间差是否小于时间间隔的阈值\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (now - last \u0026lt; delay) {\n      \u003cspan class=\"hljs-comment\"\u003e// 如果时间间隔小于我们设定的时间间隔阈值，则为本次触发操作设立一个新的定时器\u003c/span\u003e\n      clearTimeout(timer);\n      timer = setTimeout(\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) \u003c/span\u003e{\n        last = now;\n        fn.apply(context, args);\n      }, delay);\n    } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n      \u003cspan class=\"hljs-comment\"\u003e// 如果时间间隔超出了我们设定的时间间隔阈值，那就不等了，无论如何要反馈给用户一次响应\u003c/span\u003e\n      last = now;\n      fn.apply(context, args);\n    }\n  };\n}\n\n\u003cspan class=\"hljs-comment\"\u003e// 获取可视区域的高度\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e viewHeight = \u003cspan class=\"hljs-built_in\"\u003ewindow\u003c/span\u003e.innerHeight || \u003cspan class=\"hljs-built_in\"\u003edocument\u003c/span\u003e.documentElement.clientHeight;\n\u003cspan class=\"hljs-comment\"\u003e// 用新的 throttle 包装 scroll 的回调\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e lazyload = throttle(\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003e()\u003c/span\u003e =\u0026gt;\u003c/span\u003e {\n  \u003cspan class=\"hljs-comment\"\u003e// 获取所有的图片标签\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e imgs = \u003cspan class=\"hljs-built_in\"\u003edocument\u003c/span\u003e.querySelectorAll(\u003cspan class=\"hljs-string\"\u003e'#list .wrap-img img'\u003c/span\u003e);\n  \u003cspan class=\"hljs-comment\"\u003e// num 用于统计当前显示到了哪一张图片，避免每次都从第一张图片开始检查是否露出\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e num = \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e;\n  \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e (\u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e i = num; i \u0026lt; imgs.length; i++) {\n    \u003cspan class=\"hljs-comment\"\u003e// 用可视区域高度减去元素顶部距离可视区域顶部的高度\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e distance = viewHeight - imgs[i].getBoundingClientRect().top;\n    \u003cspan class=\"hljs-comment\"\u003e// 如果可视区域高度大于等于元素顶部距离可视区域顶部的高度，说明元素露出\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (distance \u0026gt;= \u003cspan class=\"hljs-number\"\u003e100\u003c/span\u003e) {\n      \u003cspan class=\"hljs-comment\"\u003e// 给元素写入真实的 src，展示图片\u003c/span\u003e\n      \u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e hasLaySrc = imgs[i].getAttribute(\u003cspan class=\"hljs-string\"\u003e'data-has-lazy-src'\u003c/span\u003e);\n      \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (hasLaySrc === \u003cspan class=\"hljs-string\"\u003e'false'\u003c/span\u003e) {\n        imgs[i].src = imgs[i].getAttribute(\u003cspan class=\"hljs-string\"\u003e'data-src'\u003c/span\u003e);\n        imgs[i].setAttribute(\u003cspan class=\"hljs-string\"\u003e'data-has-lazy-src'\u003c/span\u003e, \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e); \u003cspan class=\"hljs-comment\"\u003e// \u003c/span\u003e\n      }\n      \u003cspan class=\"hljs-comment\"\u003e// 前 i 张图片已经加载完毕，下次从第 i+1 张开始检查是否露出\u003c/span\u003e\n      num = i + \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e;\n    }\n  }\n}, \u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e);\u003c/code\u003e\u003c/pre\u003e\u003cblockquote\u003e\n\u003cp\u003e注意：给元素写入真实的 src 了之后，把 data-has-lazy-src 设置为 true ，是为了避免回滚的时候再设置真实的 src 时，浏览器会再请求这个图片一次，白白浪费服务器带宽。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e\u003cimg src=\"https://upload-images.jianshu.io/upload_images/12890819-f5e314cd7ba66cd2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003e具体细节请看文件 \u003ca href=\"https://github.com/GolderBrother/blog-react/blob/master/src/components/articles/articles.js\"\u003e文章列表\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"#toc28\"\u003e2.2 后端优化\u003c/h2\u003e\n\u003cp\u003e后端用到的技术是 node、express 和 mongodb。\u003c/p\u003e\n\u003cp\u003e后端主要问题是接口速度很慢，特别是文章列表的接口，已经是分页请求数据了，为什么还那么慢呢 ？\u003c/p\u003e\n\u003cp\u003e所以查看了接口返回内容之后，发现返回了很多列表不展示的字段内容，\u003cstrong\u003e特别是文章内容都返回了，而文章内容是很大的，占用了很多资源与带宽，从而使接口消耗的时间加长\u003c/strong\u003e。\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://upload-images.jianshu.io/upload_images/12890819-f4d6c258b69e9ce0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"列表\"\u003e\u003c/p\u003e\n\u003cp\u003e从上图可以看出文章列表接口只要返回文章的 标题、描述、封面、查看数，评论数、点赞数和时间即可。\u003c/p\u003e\n\u003cp\u003e所以把不需要给前端展示的字段注释掉或者删除。\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"code\"\u003e\u003cspan class=\"hljs-comment\"\u003e// 待返回的字段\u003c/span\u003e\n      let fields = {\n        title: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e,\n        \u003cspan class=\"hljs-comment\"\u003e// author: 1,\u003c/span\u003e\n        \u003cspan class=\"hljs-comment\"\u003e// keyword: 1,\u003c/span\u003e\n        \u003cspan class=\"hljs-comment\"\u003e// content: 1,\u003c/span\u003e\n        desc: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e,\n        img_url: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e,\n        tags: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e,\n        category: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e,\n        \u003cspan class=\"hljs-comment\"\u003e// state: 1,\u003c/span\u003e\n        \u003cspan class=\"hljs-comment\"\u003e// type: 1,\u003c/span\u003e\n        \u003cspan class=\"hljs-comment\"\u003e// origin: 1,\u003c/span\u003e\n        \u003cspan class=\"hljs-comment\"\u003e// comments: 1,\u003c/span\u003e\n        \u003cspan class=\"hljs-comment\"\u003e// like_User_id: 1,\u003c/span\u003e\n        meta: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e,\n        create_time: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e,\n        \u003cspan class=\"hljs-comment\"\u003e// update_time: 1,\u003c/span\u003e\n      };\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e同样对其他的接口都做了这个处理。\u003c/p\u003e\n\u003cp\u003e后端做了处理之后，所有的接口速度都加快了，\u003cstrong\u003e特别是文章列表接口，只用了 0.04 - 0.05 秒左右，相比之前的 4.3 秒，速度提高了 100 倍\u003c/strong\u003e，简直不要太爽， 效果如下：\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://upload-images.jianshu.io/upload_images/12890819-915be88fbe9ec915.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e此刻心情如下：\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://upload-images.jianshu.io/upload_images/12890819-d474954d87feabcf.gif?imageMogr2/auto-orient/strip\" alt=\"\"\u003e\u003c/p\u003e\n\u003ch2 id=\"#toc29\"\u003e2.3 服务器优化\u003c/h2\u003e\n\u003cp\u003e你以为前后端都优化一下，本文就完了 ？小兄弟，你太天真了，\u003cstrong\u003e重头戏在后头 ！\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://upload-images.jianshu.io/upload_images/12890819-b78c783751e5cb31.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003e笔者服务器用了 nginx 代理。\u003c/p\u003e\n\u003cp\u003e做的优化如下：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e隐藏 nginx 版本号\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e一般来说，软件的漏洞都和版本相关，所以我们要隐藏或消除 web 服务对访问用户显示的各种敏感信息。\u003c/p\u003e\n\u003cp\u003e如何查看 nginx 版本号？ 直接看 network 的接口或者静态文件请求的 Response Headers \u0008即可。\u003c/p\u003e\n\u003cp\u003e没有设置之前，可以看到版本号，比如我网站的版本号如下：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"code\"\u003eServer: nginx/\u003cspan class=\"hljs-number\"\u003e1.6\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.2\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e设置之后，直接显示 nginx 了，没有了版本号，如下：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"code\"\u003e\u003cspan class=\"hljs-built_in\"\u003eServer\u003c/span\u003e: nginx\u003c/code\u003e\u003c/pre\u003e\u003cul\u003e\n\u003cli\u003e开启 gzip 压缩\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003enginx 对于处理静态文件的效率要远高于 Web 框架，因为可以使用 gzip 压缩协议，减小静态文件的体积加快静态文件的加载速度、开启缓存和超时时间减少请求静态文件次数。\u003c/p\u003e\n\u003cp\u003e笔者开启 gzip 压缩之后，请求的静态文件大小大约减少了 2 / 3 呢。\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"code\"\u003egzip \u003cspan class=\"hljs-keyword\"\u003eon\u003c/span\u003e;\n\u003cspan class=\"hljs-comment\"\u003e#该指令用于开启或关闭gzip模块(on/off)\u003c/span\u003e\n\ngzip_buffers \u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003ek;\n\u003cspan class=\"hljs-comment\"\u003e#设置系统获取几个单位的缓存用于存储gzip的压缩结果数据流。16 8k代表以8k为单位，安装原始数据大小以8k为单位的16倍申请内存\u003c/span\u003e\n\ngzip_comp_level \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e;\n\u003cspan class=\"hljs-comment\"\u003e#gzip压缩比，数值范围是1-9，1压缩比最小但处理速度最快，9压缩比最大但处理速度最慢\u003c/span\u003e\n\ngzip_http_version \u003cspan class=\"hljs-number\"\u003e1.1\u003c/span\u003e;\n\u003cspan class=\"hljs-comment\"\u003e#识别http的协议版本\u003c/span\u003e\n\ngzip_min_length \u003cspan class=\"hljs-number\"\u003e256\u003c/span\u003e;\n\u003cspan class=\"hljs-comment\"\u003e#设置允许压缩的页面最小字节数，页面字节数从header头得content-length中进行获取。默认值是0，不管页面多大都压缩。这里我设置了为256\u003c/span\u003e\n\ngzip_proxied any;\n\u003cspan class=\"hljs-comment\"\u003e#这里设置无论header头是怎么样，都是无条件启用压缩\u003c/span\u003e\n\ngzip_vary \u003cspan class=\"hljs-keyword\"\u003eon\u003c/span\u003e;\n\u003cspan class=\"hljs-comment\"\u003e#在http header中添加Vary: Accept-Encoding ,给代理服务器用的\u003c/span\u003e\n\ngzip_types\n    \u003cspan class=\"hljs-built_in\"\u003etext\u003c/span\u003e/xml \u003cspan class=\"hljs-built_in\"\u003eapplication\u003c/span\u003e/xml \u003cspan class=\"hljs-built_in\"\u003eapplication\u003c/span\u003e/atom+xml \u003cspan class=\"hljs-built_in\"\u003eapplication\u003c/span\u003e/rss+xml \u003cspan class=\"hljs-built_in\"\u003eapplication\u003c/span\u003e/xhtml+xml image/svg+xml\n    \u003cspan class=\"hljs-built_in\"\u003etext\u003c/span\u003e/javascript \u003cspan class=\"hljs-built_in\"\u003eapplication\u003c/span\u003e/javascript \u003cspan class=\"hljs-built_in\"\u003eapplication\u003c/span\u003e/x-javascript\n    \u003cspan class=\"hljs-built_in\"\u003etext\u003c/span\u003e/x-json \u003cspan class=\"hljs-built_in\"\u003eapplication\u003c/span\u003e/json \u003cspan class=\"hljs-built_in\"\u003eapplication\u003c/span\u003e/x-web-app-manifest+json\n    \u003cspan class=\"hljs-built_in\"\u003etext\u003c/span\u003e/css \u003cspan class=\"hljs-built_in\"\u003etext\u003c/span\u003e/plain \u003cspan class=\"hljs-built_in\"\u003etext\u003c/span\u003e/x-component\n    font/opentype font/ttf \u003cspan class=\"hljs-built_in\"\u003eapplication\u003c/span\u003e/x-font-ttf \u003cspan class=\"hljs-built_in\"\u003eapplication\u003c/span\u003e/vnd.ms-fontobject\n    image/x-icon;\n\u003cspan class=\"hljs-comment\"\u003e#进行压缩的文件类型,这里特别添加了对字体的文件类型\u003c/span\u003e\n\ngzip_disable \u003cspan class=\"hljs-string\"\u003e\"MSIE [1-6]\\.(?!.*SV1)\"\u003c/span\u003e;\n\u003cspan class=\"hljs-comment\"\u003e#禁用IE 6 gzip\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e把上面的内容加在 nginx 的配置文件 ngixn.conf 里面的 http 模块里面即可。\u003c/p\u003e\n\u003cp\u003e是否设置成功，看文件请求的 Content-Encoding 是不是 gzip 即可。\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://upload-images.jianshu.io/upload_images/12890819-092240d63c0f469e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"\"\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e设置 expires，设置缓存\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"code\"\u003e \u003cspan class=\"hljs-section\"\u003eserver\u003c/span\u003e {\n        \u003cspan class=\"hljs-attribute\"\u003elisten\u003c/span\u003e       \u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e;\n        \u003cspan class=\"hljs-attribute\"\u003eserver_name\u003c/span\u003e  localhost;\n        \u003cspan class=\"hljs-attribute\"\u003elocation\u003c/span\u003e  / {\n            \u003cspan class=\"hljs-attribute\"\u003eroot\u003c/span\u003e   /home/blog/blog-react/build/;\n            \u003cspan class=\"hljs-attribute\"\u003eindex\u003c/span\u003e  index.html;\n            \u003cspan class=\"hljs-attribute\"\u003etry_files\u003c/span\u003e \u003cspan class=\"hljs-variable\"\u003e$uri\u003c/span\u003e \u003cspan class=\"hljs-variable\"\u003e$uri\u003c/span\u003e/ \u003cspan class=\"hljs-variable\"\u003e@router\u003c/span\u003e;\n            \u003cspan class=\"hljs-attribute\"\u003eautoindex\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003eon\u003c/span\u003e;\n            \u003cspan class=\"hljs-attribute\"\u003eexpires\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e7d\u003c/span\u003e; \u003cspan class=\"hljs-comment\"\u003e# 缓存 7 天\u003c/span\u003e\n        }\n    }\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e我重新刷新请求的时候是 2019 年 3 月 16 号，是否设置成功看如下几个字段就知道了：\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://upload-images.jianshu.io/upload_images/12890819-324f8229ee54440c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"\"\u003e\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eStaus Code 里面的 form memory cache 看出，文件是直接从本地浏览器本地请求到的，没有请求服务器。\u003c/li\u003e\n\u003cli\u003eCache-Control 的 max-age= 604800 看出，过期时间为 7 天。\u003c/li\u003e\n\u003cli\u003eExpress 是 2019 年 3 月 23 号过期，也是 7 天过期。\u003c/li\u003e\n\u003c/ol\u003e\n\u003cblockquote\u003e\n\u003cp\u003e注意：上面最上面的用红色圈中的 Disable cache 是否是打上了勾，打了勾表示：浏览器每次的请求都是请求服务器，无论本地的文件是否过期。所以要把这个勾去掉才能看到缓存的效果。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp\u003e终极大招：\u003cstrong\u003e服务端渲染 SSR\u003c/strong\u003e，也是笔者接下来的方向。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch4 id=\"#toc410\"\u003e3.1 测试场景\u003c/h4\u003e\n\u003cp\u003e一切优化测试的结果脱离了实际的场景都是在耍流氓，而且不同时间的网速对测试结果的影响也是很大的。\u003c/p\u003e\n\u003cp\u003e所以笔者的测试场景如下：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ea. 笔者的服务器是阿里的，配置是入门级的学生套餐配置，如下：\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg src=\"https://upload-images.jianshu.io/upload_images/12890819-bde4a529183ff1f7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"服务器配置\"\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eb. 测试网络为 10 M 光纤宽带。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"#toc411\"\u003e3.2 优化结果\u003c/h4\u003e\n\u003cp\u003e\u003cstrong\u003e优化之后的首屏速度是 2.07 秒。\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://upload-images.jianshu.io/upload_images/12890819-befa6b7c01219e5c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003e最后加了缓存的结果为 0.388 秒\u003c/strong\u003e。\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://upload-images.jianshu.io/upload_images/12890819-7ae2673d65cd6a0d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e再来看下 Lighthouse 的测试结果：\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://upload-images.jianshu.io/upload_images/12890819-c89d85fe22d27f8c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"image.png\"\u003e\u003c/p\u003e\n\u003cp\u003e比起优化之前，各项指标都提升了很大的空间。\u003c/p\u003e\n\u003ch1 id=\"#toc112\"\u003e4. 最后\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003e优化之路漫漫，永无止境，天下武功，唯快不破。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e本次优化的前端与后端项目，都已经开源在 github 上了，欢迎围观。\u003c/p\u003e\n\u003cp\u003e前端：\u003ca href=\"https://github.com/GolderBrother/blog-react\"\u003ehttps://github.com/GolderBrother/blog-react\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e后端：\u003ca href=\"https://github.com/GolderBrother/blog-node-egg\"\u003ehttps://github.com/GolderBrother/blog-node-egg\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003egithub 地址：\u003ca href=\"https://github.com/GolderBrother\"\u003ehttps://github.com/GolderBrother\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e如果您觉得这篇文章不错或者对你有所帮助，请给个赞或者星呗，你的点赞就是我继续创作的最大动力。\u003c/p\u003e\n\u003c/div\u003e\u003c/div\u003e","like_users":[],"create_time":{"$date":"2019-06-06T16:03:07.587Z"},"update_time":{"$date":"2019-06-06T16:03:07.587Z"},"id":3,"__v":0}
